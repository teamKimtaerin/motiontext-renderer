# 제목: M6 타임라인 rVFC 전환, snapToFrame 연동, 테스트 추가

## 변경 개요
- Timeline을 rAF에서 requestVideoFrameCallback(rVFC) 기반으로 전환하고, 폴백(rAF) 유지
- rVFC 경로에서 `metadata.mediaTime` 사용하여 프레임 정합성 강화
- `ended` 이벤트에서 루프 중지, 일시정지/시킹 시 이벤트 기반 notify 유지
- `setRate(rate)` API 추가(`video.playbackRate` 위임)
- `snapToFrame` 옵션(Scenario.behavior.snapToFrame + timebase.fps) 을 합성 파이프라인에 연결
- 테스트 갱신/추가로 회귀 방지

## 상세 변경
- src/core/TimelineController.ts
  - vFC 루프(`loopVfc`) + rAF 폴백(`loopRaf`) 도입, 공통 `publish()`로 통합
  - `metadata.mediaTime` 우선 사용, 불가 시 `video.currentTime`
  - `ended` 이벤트 처리 추가(`stop(false)`), detach 시 모든 리스너 제거
  - rAF/vFC ID 분리 관리 및 정확한 취소
  - `setRate(rate)` 추가
- src/core/Renderer.ts
  - `composeActive` 호출 시 `{ fps, snapToFrame }` 옵션 전달
- src/composer/PluginChainComposer.ts
  - `ComposeOptions` 도입, `windowEval`/`composeActive`가 옵션 객체를 받아 `computeRelativeWindow`에 `fps/snapToFrame` 전달
- src/index.ts
  - `MotionTextRenderer.setRate(rate)` 파사드 추가
- 테스트
  - src/composer/__tests__/PluginChainComposer.test.ts: 옵션 객체 시그니처 반영
  - src/core/__tests__/TimelineController.test.ts: rVFC 틱(mediaTime), 일시정지/시킹 즉시 반영, ended 중지, setRate 테스트 추가

## 결과
- `pnpm build` 성공 (vite + dts)
- 타입체크 통과
- 테스트 139/139 통과
- 시나리오의 `snapToFrame` on/off 시 [t0, t1) 경계 판정 일관성 유지

## 주의/후속
- 데모(브라우저)에서 회귀 육안 확인 권장: 재생/일시정지/시킹/배속/경계 프레임
- fps가 지정되지 않은 상태에서 snapToFrame=true인 경우: 스냅 비활성(옵션 전달만, 기본값 없음)
- Transform 순서 재검토는 별도 이슈로 유지(M6 스코프 외)

